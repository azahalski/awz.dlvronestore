[b]Модуль добавляет правило ограничения в доставки и позволяет проверить наличие всех товаров на одном из складов.[/b]

[size=20pt][b]Основные возможности[/b][/size]

[list]
[*][b]Проверка наличия всех товаров на одном складе[/b]: Модуль проверяет, есть ли все товары из корзины на одном из выбранных складов. Если хотя бы одного товара нет в нужном количестве на складе, способ доставки будет недоступен для заказа.
[*][b]Интеграция с компонентом заказа[/b]: Модуль подключается к событиям [b]OnSaleComponentOrderJsData[/b] и [b]OnSaleComponentOrderDeliveriesCalculated[/b], что позволяет динамически обновлять список доступных способов доставки и отображать предупреждения пользователю.
[*][b]Фильтрация складов[/b]: При недоступности доставки на некоторых складах модуль автоматически скрывает их из списка и показывает соответствующее сообщение пользователю.
[/list]

[size=20pt][b]Как это работает[/b][/size]

[list=1]
[*]При расчете доставок модуль получает список товаров в корзине и их количество.
[*]Для каждого товара проверяется наличие на складах, указанных в настройках правила ограничения.
[*]Если все товары есть в нужном количестве на каком-либо складе из списка — доставка доступна.
[*]Если товары есть только на части складов — доставка доступна только для этих складов, остальные склады скрываются.
[*]Если товаров нет ни на одном из складов — доставка недоступна, показывается сообщение об ошибке.
[/list]

[size=20pt][b]Техническая реализация[/b][/size]

Модуль использует класс [b]\Awz\Dlvronestore\AwzCheckOneStoreDeliveryRestrictions[/b], который наследуется от [b]Bitrix\Sale\Delivery\Restrictions\Base[/b] и реализует метод [b]check()[/b] для проверки ограничений. Также используются обработчики событий в классе [b]Handlers[/b] для интеграции с компонентом заказа.

[size=24pt][b]Настройки и параметры конфигурации[/b][/size]

Модуль не имеет отдельных настроек в админке. 
Конфигурация осуществляется через правила ограничений доставки в выбранном профиле доставки (Магазин - настройки - службы доставки) → [b]"Ограничения"[/b] → Добавить ограничение → [b]по наличию всех товаров на одном складе[/b] в админпанели Bitrix.

[size=22pt][b]Параметры правила ограничения[/b][/size]

[list]
[*][b]Сообщение о недоступности доставки[/b]: Текст, который будет показан пользователю, если ни на одном складе нет всех товаров из заказа.
[*][b]Сообщение о недоступности доставки на части складов[/b]: Текст, который будет показан, если товары есть только на части складов.
[*][b]Склады проверки[/b]: Выберите склады, на которых будет проверяться наличие товаров. Можно выбрать несколько складов.
[/list]
